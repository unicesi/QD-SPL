<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>UML2Ecore Reference</title><link rel="stylesheet" href="../book.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="index.html" title="openArchitectureWare User Guide"><link rel="up" href="reference.html" title="Part&nbsp;II.&nbsp;Reference"><link rel="prev" href="recipe.html" title="Recipe Framework"><link rel="next" href="classic_reference.html" title="&#34;Classic&#34; Reference"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="uml2ecore_reference"></a>UML2Ecore Reference</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_intro">What is UML2Ecore?</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_setup_eclipse">Setting up Eclipse</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_toolsupport">UML Tool Support</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_setup_metamodel">Setting up your metamodel project</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_invoking_generator">Invoking the Generator</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_generated_model">The generated Model</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_naming">Naming</a></span></dt><dt><span class="section"><a href="uml2ecore_reference.html#uml2ecore_reference_modularizing">Modularizing the metamodel file</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_intro"></a>What is UML2Ecore?</h2></div></div></div><p>Building metamodels with the internal tools of EMF is tedious. Using
    the tree view based editors does not scale. Once you are at more than,
    say, 30 metaclasses, things become hard to work with. The same is true for
    the Ecore editor of GMF. Since you cannot easily factor a large metamodel
    into several diagrams, the diagram get cluttered and layouting becomes
    almost impossible.</p><p>One way to solve this problem is to use UML tools to draw the
    metamodel and then transform the UML model into an Ecore instance.</p><p>The oAW uml2ecore utiliy transforms a suitably structured Eclipse
    UML2 model (which can be created using various tools) into an Ecore
    file.</p><p>Note that this tool also serves as a tutorial for writing
    model-to-model transformations. This aspect, however, is documented
    elsewhere. This document only shows how to use the uml2ecore tool.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_setup_eclipse"></a>Setting up Eclipse</h2></div></div></div><p>You need an installation of oAW 4.3 including the UML2 support. Run
    the UML2 example (available for download on the oAW download page <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.eclipse.org/gmt/oaw/download" target="_top">http://www.eclipse.org/gmt/oaw/download</a>) to verify that you
    have all the UML2 stuff installed.</p><p>The only additional thing required is that you install the
    <span class="emphasis"><em>UML2Ecore</em></span> plugin into your Eclipse installation. The
    plugin is part of the oAW 4.3 distribution.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_toolsupport"></a>UML Tool Support</h2></div></div></div><p>Of course, you could use the tree editors supplied by UML2 for
    drawing the UML2 model that should be transformed into Ecore. However,
    this is useless, since then you are back to square one: tree editors. So
    you need to use an UML tool that is able to export the model in the
    <span class="emphasis"><em>Eclipse UML2 2.0</em></span> format. For example, MagicDraw 11.5
    (or above) can do that; this tool (MD 11.5) is also the one we tested the
    <code class="classname">uml2ecore</code> utility with.</p><p>Note that we do not use any profiles in the
    <code class="classname">uml2ecore</code> utility. Although using profiles might
    make the metamodel a bit more expressive, we decided not to use a specific
    profile, to reduce the potential for compatibility problems (with the
    various tools).</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_setup_metamodel"></a>Setting up your metamodel project</h2></div></div></div><p>You should first create a new Generator project (select
    <span class="emphasis"><em>File-&gt;New-&gt;Other-&gt;openArchitectureWare/Generator
    Project</em></span>).</p><p>Then open your UML2 tool of choice (we will use MagicDraw here) and
    draw a class diagram that resembles your metamodel. Here is the one we
    have drawn as an example for this document:</p><div class="figure"><a name="d0e10267"></a><p class="title"><b>Figure&nbsp;37.&nbsp;UML2Ecore sample metamodel - class diagram</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/u10_uml2ecore/model.jpg" alt="UML2Ecore sample metamodel - class diagram"></div></div></div><br class="figure-break"><p>This is the usual metamodel for entities and such. Nothing special.
    Also, the name of the model defines the name of the Ecore metamodel; here
    is the MagicDraw tree view to illustrate this:</p><div class="figure"><a name="d0e10277"></a><p class="title"><b>Figure&nbsp;38.&nbsp;UML2Ecore sample metamodel - MagicDraw containment tree</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/u10_uml2ecore/mdtree.jpg" alt="UML2Ecore sample metamodel - MagicDraw containment tree"></div></div></div><br class="figure-break"><p>You now have to save/export this model in Eclipse UML2 format. In
    MagicDraw, you do this by selecting <span class="guiicon">File</span> &#8594; <span class="guimenuitem">Export</span> &#8594; <span class="guimenuitem">Eclipse UML2</span>. The exported files have to be in the <span class="emphasis"><em>root of
    the src folder</em></span> in the metamodel project created above. This is
    how the project looks like after this step, assuming you would have called
    your model <code class="filename">entity.uml2</code>:</p><div class="figure"><a name="d0e10301"></a><p class="title"><b>Figure&nbsp;39.&nbsp;Project layout</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/u10_uml2ecore/project.png" alt="Project layout"></div></div></div><br class="figure-break"><p>Before you can actually run the generator, you have to make sure
    that your project has a plugin dependency to the uml2ecore plugin.
    Double-Click on the plugin manifest file, select the
    <span class="emphasis"><em>Dependencies</em></span> tab and click add. Select the
    <span class="package">org.openarchitectureware.uml2ecore</span> plugin. The result
    looks like this:</p><div class="figure"><a name="d0e10317"></a><p class="title"><b>Figure&nbsp;40.&nbsp;Dependencies</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/u10_uml2ecore/dep.png" alt="Dependencies"></div></div></div><br class="figure-break"><p>In the current version, you also need a dependency to the
    <code class="classname">org.openarchitectureware.util.stdlib</code> project. Later
    versions of the <code class="classname">uml2ecore</code> plugin will reexport that
    dependency, so that you will not need to add it you your projects
    manually.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_invoking_generator"></a>Invoking the Generator</h2></div></div></div><p>As usual, you have to write a workflow file. It also has to reside
    in your project source folder. Here is how it looks:</p><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;workflow&gt;
&lt;cartridge
	file="org/openarchitectureware/util/uml2ecore/uml2ecoreWorkflow.oaw"
		uml2ModelFile="org/openarchitectureware/uml2ecore/test/data/entity.uml2"
		outputPath="out"
		nsUriPrefix="http://www.voelter.de"
		includedPackages="Data"
		resourcePerToplevelPackage="false"
		addNameAttribute="false"/&gt;
&lt;/workflow&gt;</pre><p>As you might expect, it simply calls a cartridge supplied by
    uml2ecore plugin. You have to define the following properties:</p><div class="table"><a name="d0e10343"></a><p class="title"><b>Table&nbsp;26.&nbsp;UML2Ecore - Cartridge properties</b></p><div class="table-contents"><table summary="UML2Ecore - Cartridge properties" cellspacing="0" cellpadding="10" width="100%" border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left"><col align="left"></colgroup><thead><tr><th style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left">Property</th><th style="border-bottom: 2 solid #000000; " align="left">Description</th></tr></thead><tbody><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>uml2ModelFile</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">The is the name of your UML2 file that contains the
              model; as usual, the file is looked for in the classpath (that
              is why you had to move it into the source folder)</td></tr><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>addNameAttribute</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">This determines whether automatic namespace management
              and naming is turned on (see the end of this document). For the
              simple example, please set the value to be false.
              <em class="parameter"><code>true/false</code></em></td></tr><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>nsUriPrefix</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">The nsUriPrefix is used to assemble the namespace URI.
              The name of the metamodel, as well as the nsPrefix, will be
              derived from the UML model name; so in our example, the nsPrefix
              and the name of the generated EPackage will be entitymm. The
              complete namespace URL also required by Ecore is created by
              concatenating the nsUriPrefix given here, and the name. The
              resulting namespace URL in the example will thus be <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.voelter.de/entitymm" target="_top">http://www.voelter.de/entitymm</a>.</td></tr><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>includedPackages</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">This property etermines which packages the transformer
              should consider when transforming the model; note that the
              contents of all the packages will be put into the root
              <code class="classname">EPackage</code>.</td></tr><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>outputPath</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">This property etermines where the resulting files are
              written to.</td></tr><tr><td style="border-right: 2 solid #000000; border-bottom: 2 solid #000000; " align="left"><em class="parameter"><code>resourcePerToplevelPackage</code></em></td><td style="border-bottom: 2 solid #000000; " align="left">It set to <code class="varname">true</code>, the generator will
              write a separate Ecore file for each of the top level packages
              in you UML model filtered by the value of the propery
              <em class="parameter"><code>includedPackages</code></em>. Useful for modularizing
              metamodels (see the end of this chapter).</td></tr><tr><td style="border-right: 2 solid #000000; " align="left"><em class="parameter"><code>nameUnnamedNavigableAssociationEnds</code></em></td><td style="" align="left">If set to <code class="varname">true</code>, all unnamed navigable
              association ends will be initialized with the name of the target
              type.</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>You can now run this workflow by selecting <span class="emphasis"><em>Run As -&gt;
    oAW Workflow</em></span>. The name of the generated Ecore file will
    correspond to the name of the root Model element in the UML model.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_generated_model"></a>The generated Model</h2></div></div></div><p>Here is a screenshot of the generated model:</p><div class="figure"><a name="d0e10424"></a><p class="title"><b>Figure&nbsp;41.&nbsp;Generated Ecore model</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/u10_uml2ecore/ecoremodel.jpg" alt="Generated Ecore model"></div></div></div><br class="figure-break"><p>The generator also creates a constraints file (called
    <code class="filename">entitymmConstraints.chk</code>) which contains a number of
    constraints; currently these are specifically the checks for the minimum
    multiplicity in references (an error is reported if the minimum
    multiplicity is one, but the reference is null or empty, respectively).
    You can integrate the generated constraints file into your workflow using
    the usual approach.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_naming"></a>Naming</h2></div></div></div><p>It is often the case the basically all model elements in a model
    should have a name. It might not always be necessary from a domain
    perspective, but it is really useful for debugging. Of course, you can add
    a superclass called <code class="classname">Named</code> with a single attribute
    <code class="methodname">name</code> to all you classes. However, if you set the
    <em class="parameter"><code>addNameAttribute</code></em> parameter to be true when calling
    the uml2ecore cartridge, every class which does not inherit from another
    class gets an additional <code class="methodname">name</code> attribute. Also,
    constraints that make sure that names within a namespace (i.e. a
    containment reference) are unique.</p><p>uml2ecore also comes with a utility extension called
    <code class="classname">org::openarchitectureware::util::stdlib::naming</code>
    that can calculate the <code class="methodname">namespace()</code> and the
    <code class="methodname">qualifiedName()</code> for every model element that has
    a name.</p><p>Another convenience is the parameter
    <em class="parameter"><code>nameUnnamedNavigableAssociationEnds</code></em>. Often you
    specify a relationship between two metaclasses and give the target end the
    name of the target metaclass. Let us say you specify an association from
    metaclass <code class="classname">Application</code> to
    <code class="classname">Component</code>. It is likely that the target end will be
    called <code class="methodname">component</code>. By setting the parameter to
    true all unnamed navigable association ends will get the name of the
    target class. If there is more than one unnamed association only the first
    one will be modified. This would lead to a failing constraint afterwards,
    since at least after this modification all navigable association ends must
    be named.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="uml2ecore_reference_modularizing"></a>Modularizing the metamodel file</h2></div></div></div><p>You can modularize the metamodel. If you specify the
    <em class="parameter"><code>resourcePerToplevelPackage=&acirc;&#128;&#156;true&acirc;&#128;&#156;</code></em> parameter to
    the cartridge call, you will get a separate Ecore file for each top level
    package, as well as a separate constraint check file.</p></div></div></body></html>